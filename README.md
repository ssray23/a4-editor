# A4 Editor

> **"Can't go back to Word now!"** - The revolutionary web-based document editor that redefines what professional document creation should be.

A stunning, modern WYSIWYG document editor that creates beautiful A4-formatted documents with unparalleled styling and advanced formatting capabilities. Built with React and featuring a gorgeous theme-based UI that adapts to your brand colors. Say goodbye to clunky desktop software - this is document editing, reimagined for the modern web.

## 🌟 Why A4 Editor Changes Everything

**Beyond Traditional Word Processors:**
- ✨ **Instant Theme Integration** - Your brand colors flow throughout the entire interface and documents
- 🎨 **Stunning Visual Design** - Modern frosted glass effects and perfectly centered toolbars
- 🚀 **Zero Installation** - Works instantly in any browser, no downloads or updates required
- 💾 **Perfect Import/Export** - 100% fidelity with standalone HTML files that work everywhere
- 🎯 **Smart Content Management** - Drag-and-drop organization with intelligent content placement
- 📊 **Advanced Components** - Tables, stats, timelines, and cards that Word simply can't match

## 🚀 Features Overview

### 📝 Content Elements
- **Headings** (H1, H2, H3) with theme color support
- **Paragraphs** with rich text formatting and HTML support
- **Tables** with advanced editing and formatting capabilities
- **Stat Grids** for displaying metrics and key performance indicators
- **Fact Boxes** for highlighting important information
- **Cards** with rich text formatting for structured content
- **Timelines** for chronological content presentation
- **Citations** for references and academic sources
- **Horizontal Dividers** for content separation

### ✨ Rich Text Editing
- **Universal Bold Button** - appears in toolbar when text is selected
- **Visual State Feedback** - button shows white (unformatted) or black (bold)
- **WYSIWYG Editing** - what you see is exactly what you get
- **HTML Preservation** - maintains formatting in export and import
- **Keyboard Shortcuts** - Ctrl+B for bold formatting anywhere

### 🎨 Theme & Customization
- **Color Picker** - customize theme color throughout document
- **Theme Toggle** - apply theme colors to headings and dividers
- **Real-time Updates** - see changes immediately
- **Persistent Settings** - theme preferences saved across sessions
- **Professional Styling** - clean, modern design aesthetic

### 📊 Advanced Table Editor
- **Dynamic Size** - starts as 3x3, expand/contract as needed
- **Rich Text in Cells** - full HTML formatting support including bold
- **Column Resizing** - drag handles for precise width control
- **Row/Column Management** - add/delete with intuitive controls
- **Header Editing** - click-to-edit column headers
- **Cell-Level Formatting** - bold text preserved in export
- **Professional Styling** - theme colors, borders, alternating rows

### 🔄 Document Management
- **Drag & Drop Reordering** - rearrange content blocks easily
- **Smart Insertion** - new elements added after currently selected block
- **Auto-Selection** - newly created blocks are immediately selected
- **Context-Aware Placement** - intelligent content positioning
- **Real-time Persistence** - automatic saving to localStorage

### 📤 Export & Import
- **HTML Export** - complete standalone documents with embedded CSS
- **Perfect Import Fidelity** - reload exported files with 100% formatting preservation
- **Theme Color Restoration** - automatically detects and restores theme colors
- **Complete Format Preservation** - bold text, colors, table formatting, all maintained
- **CSS-to-HTML Conversion** - smart detection of both HTML tags and CSS styling
- **No Dependencies** - exported files work anywhere, completely self-contained
- **Professional Output** - print-ready A4 formatting with full visual fidelity

## 🛠️ How to Use

### Getting Started
1. **Open the Editor** - Start with a default document template
2. **Add Content** - Use toolbar buttons to insert different content types
3. **Edit Content** - Click on any element to edit it inline
4. **Format Text** - Select text and use the bold button (B) in the toolbar
5. **Customize Theme** - Use the color picker (🎨) to match your brand
6. **Reorder Content** - Drag and drop elements to reorganize
7. **Export** - Click "Export HTML" to save your document

### Content Creation Workflow

#### Text Elements
- **📃 H1, H2, H3** - Click to add headings, type to edit
- **📄 Paragraph** - Click to add text blocks with rich formatting
- **💡 Fact Box** - Highlighted information with left border
- **🎴 Card** - Styled content boxes with background and shadow
- **📚 Citation** - Italicized text for references

#### Advanced Elements
- **📊 Table** - Professional tables with full editing capabilities
- **📈 Stat Grid** - 3-column metrics display with editable values
- **⏰ Timeline** - Chronological events with year and description
- **➖ Divider** - Horizontal lines for content separation

### Rich Text Editing

#### Universal Bold Formatting
- **Smart Detection** - Bold button appears when editing text elements
- **Visual Feedback** - Button color indicates current formatting state:
  - **White Button** - Text is not bold, click to make bold
  - **Black Button** - Text is bold, click to remove bold
- **Persistent Button** - Stays visible while editing for easy access
- **Works Everywhere** - Paragraphs, cards, facts, citations, table cells

#### Text Formatting Process
1. **Click into any text element** (paragraph, card, etc.)
2. **Select text** you want to format
3. **Bold button (B) appears** in the toolbar
4. **Click B or press Ctrl+B** to toggle bold formatting
5. **Formatting preserved** in both editor and export

### Table Editing Mastery

#### Creating and Basic Editing
1. **Add Table** - Click table button (📊) to create 3x3 table
2. **Edit Headers** - Click on column headers to rename
3. **Edit Cells** - Click in any cell to start typing
4. **Rich Formatting** - Select text in cells and use bold button

#### Advanced Table Management
- **Column Resizing**:
  - Hover between column headers to see resize cursor
  - Drag left/right to adjust column width
  - Changes apply immediately
- **Row Operations**:
  - Click ➕ at end of any row to add new row below
  - Click ❌ button in row to delete that row
- **Column Operations**:
  - Click ➕ at bottom of table to add new column
  - Click ❌ in header to delete that column

#### Table Cell Formatting
- **Bold Text** - Select text in any cell, use bold button or Ctrl+B
- **HTML Support** - Formatting preserved in export
- **Text Wrapping** - Long text wraps naturally within cells
- **Professional Styling** - Alternating row colors, theme-colored headers

### Theme Customization

#### Color System
- **🎨 Color Picker** - Click to open theme color selector
- **H Theme Toggle** - Switch between black and theme-colored headings
- **Real-time Updates** - Changes apply immediately to all elements
- **Persistent Settings** - Theme choices saved in browser

#### Theme-Aware Elements
- **Headings** - Can use theme color when toggle is enabled
- **Table Headers** - Always use theme color for professional look
- **Fact Boxes** - Left border matches theme color
- **Stats Grids** - Background and text colors use theme
- **Timelines** - Border and year highlights use theme color
- **Dividers** - Line color follows theme or stays black

### Smart Content Management

#### Intelligent Insertion
- **Context-Aware** - New elements inserted after currently selected block
- **Logical Fallback** - When nothing selected, adds to end
- **Auto-Selection** - New blocks immediately selected for editing
- **Visual Feedback** - Clear indication of current selection

#### Content Organization
- **Drag & Drop** - Click and drag any element to reorder
- **Visual Indicators** - Clear selection outlines and controls
- **Delete Controls** - Click 🗑️ on any selected element to remove
- **Persistent State** - Document structure saved automatically

### Export & Import Features

#### Export Process
1. **Click "📤 Export HTML"** in toolbar
2. **Complete Document** - Generates standalone HTML file
3. **Embedded CSS** - All styling included, no external dependencies
4. **Format Preservation** - Exact appearance maintained
5. **Professional Output** - A4-sized, print-ready document

#### Import Process
1. **Click "📥 Import HTML"** in toolbar
2. **Select File** - Choose previously exported HTML file
3. **Automatic Parsing** - Recreates all content blocks with perfect fidelity
4. **Theme Color Detection** - Automatically extracts and applies original theme colors
5. **Format Recognition** - Preserves all text formatting (HTML tags + CSS styles)
6. **Smart Conversion** - Converts CSS bold styling to editable HTML tags
7. **Complete Restoration** - Theme toggle state, colors, and formatting fully restored
8. **Continue Editing** - All imported content remains fully editable

## 🔧 Technical Architecture

### Built With
- **React 19** - Latest React features with modern hooks
- **@hello-pangea/dnd** - Smooth drag and drop functionality
- **react-color** - Professional color picker component
- **CSS-in-JS** - Dynamic theme system with real-time updates

### CSS Architecture
The application uses a **dual CSS system** for optimal functionality:

#### A4.css (Reference Stylesheet)
- **Complete Document System** - Comprehensive styling with responsive design and print optimizations
- **Media Queries** - Responsive breakpoints (`@media (max-width: 1600px)`) and print styles (`@media print`)
- **Advanced Components** - Full styling for citations, figures, diagrams, code blocks, and utility classes
- **Template Variables** - Uses `{theme_color}` placeholders for theme integration
- **Print-Ready** - Optimized for PDF generation and professional document output

#### JavaScript-Generated CSS (Dynamic Styles)
- **Editor-Optimized** - Focused on editing experience and user interaction
- **RTL Override System** - Comprehensive `direction: ltr !important` enforcement
- **Dynamic Theming** - Real-time `${theme}` variable injection based on user selection
- **Interactive States** - Button hover effects, animations, and editing-specific styling
- **Editing Features** - ContentEditable optimizations, table editing states, and WYSIWYG enhancements

#### Key Architectural Differences
| Feature | A4.css | JavaScript CSS |
|---------|--------|----------------|
| **Purpose** | Document presentation | Editor functionality |
| **Responsive** | ✅ Full breakpoints | ❌ Editor-focused only |
| **Print Support** | ✅ Print optimizations | ❌ Not included |
| **Components** | ✅ Citations, figures, diagrams | ❌ Core elements only |
| **Theme System** | Static placeholders | ✅ Dynamic injection |
| **RTL Handling** | Targeted fixes | ✅ Aggressive overrides |
| **Editing States** | ❌ Not included | ✅ Comprehensive |

#### Why This Approach?
- **Separation of Concerns** - Document presentation vs. editing functionality
- **Performance** - Dynamic CSS only loads editing-specific styles
- **Maintainability** - Clear distinction between display and interaction styling
- **Flexibility** - Can optimize each system for its specific use case

#### CSS Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                        A4 Editor Architecture                   │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────┐    ┌─────────────────────────────────────┐
│       A4.css        │    │        JavaScript CSS Engine        │
│   (Reference)       │    │         (Runtime)                   │
├─────────────────────┤    ├─────────────────────────────────────┤
│ • Complete system   │    │ • getStyle() function              │
│ • Responsive design │────│ • Dynamic ${theme} injection       │
│ • Print styles      │    │ • RTL overrides                    │
│ • Advanced comps    │    │ • Editing states                   │
│ • Static templates  │    │ • Interactive features             │
└─────────────────────┘    └─────────────────────────────────────┘
           │                                  │
           │                                  ▼
           │                    ┌─────────────────────────────────┐
           │                    │       Style Injection           │
           │                    │   document.createElement()     │
           │                    │   <style id="a4-style">        │
           │                    └─────────────────────────────────┘
           │                                  │
           ▼                                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                      Browser DOM                                │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌────────────────┐   │
│  │  Editor View    │  │  Export HTML    │  │  Print View    │   │
│  │  ──────────     │  │  ──────────     │  │  ──────────    │   │
│  │ JS CSS Active   │  │ JS CSS Embedded │  │ A4.css Rules   │   │
│  │ RTL Overrides   │  │ Theme Injected  │  │ Media Queries  │   │
│  │ Editing States  │  │ Self-contained  │  │ Optimizations  │   │
│  └─────────────────┘  └─────────────────┘  └────────────────┘   │
└─────────────────────────────────────────────────────────────────┘

Flow:
1. A4.css defines complete document system (width: 21cm, etc.)
2. JavaScript getStyle() generates editor-optimized CSS
3. Runtime injects dynamic styles with theme colors
4. Export embeds same JS CSS for standalone documents
5. Print inherits A4.css responsive/print optimizations
```

### Data Structure
Documents stored as block arrays with this structure:
```javascript
{
  id: "unique-id",
  type: "h1|h2|h3|p|table|stat-grid|fact|card|timeline|citation|hr",
  html: "content", // HTML content for text blocks
  table: { // For table blocks
    cols: ["Header 1", "Header 2"],
    rows: [["Cell 1", "Cell 2"]],
    colWidths: {0: 150, 1: 200},
    boldCells: ["0-1", "1-2"]
  },
  stats: [...], // For stat-grid blocks
  events: [...] // For timeline blocks
}
```

### Theme System
- **Dynamic CSS Generation** - Theme colors injected into CSS templates
- **Real-time Updates** - Styles change immediately when theme modified
- **localStorage Persistence** - Theme preferences saved automatically
- **Fallback Handling** - Graceful degradation if storage fails

### Rich Text Engine
- **ContentEditable Elements** - Native browser text editing for all text blocks
- **HTML Preservation** - Maintains formatting tags throughout edit/export/import cycle
- **Universal Bold Detection** - Intelligent scanning of DOM for formatting state
- **Cross-Element Consistency** - Same formatting experience across all content types
- **Smart Import Processing** - Converts both HTML tags and CSS styles to editable format
- **Format Fidelity** - 100% preservation of formatting through complete workflow cycle

## 💾 Data Persistence

### Automatic Saving
- **Real-time Persistence** - Changes saved immediately to localStorage
- **Multiple Keys**:
  - `a4.blocks.v2` - Document content and structure
  - `a4.theme` - Selected theme color
  - `a4.useThemeColor` - Theme toggle state
- **Error Handling** - Graceful fallback if localStorage unavailable
- **Version Management** - Data structure versioning for future updates

### Export Format
- **Standalone HTML** - Complete documents with embedded CSS and all assets
- **Perfect Fidelity** - Exported files match editor appearance exactly
- **Theme Preservation** - Color schemes embedded in CSS for accurate reproduction
- **Format Integrity** - Bold text, table styling, and all formatting preserved
- **A4 Formatting** - Professional print-ready layout with precise dimensions
- **Cross-Platform** - Works on any device/browser without modifications
- **Zero Dependencies** - Exported files completely self-contained and portable

## 🎯 Professional Features

### A4 Document Formatting
- **Standard Dimensions** - 21cm × 29.7cm with proper margins
- **Typography** - Helvetica font family throughout
- **Professional Spacing** - Consistent margins and padding
- **Print Optimization** - Clean output for PDF generation

### Visual Design System
- **Consistent Styling** - Unified design language across all elements
- **Theme Integration** - Color coordination throughout document
- **Responsive Layout** - Scales appropriately for different screen sizes
- **Touch-Friendly** - Works well on tablets and mobile devices

### Enterprise-Ready
- **No Server Required** - Runs entirely in browser
- **Privacy Focused** - All data stays on user's device
- **Fast Performance** - Optimized React architecture
- **Cross-Browser** - Works on all modern browsers

## 🚀 Getting Started

### Installation & Setup
```bash
# Clone the repository
git clone <repository-url>
cd a4-editor

# Install dependencies
npm install

# Start development server
npm start

# Build for production
npm run build
```

### Development
- **Hot Reload** - Changes reflect immediately during development
- **Modern React** - Uses latest React 19 features
- **Clean Code** - Well-structured, maintainable codebase
- **No External APIs** - Fully self-contained application

### Deployment
- **Static Site** - Deploy anywhere static sites are supported
- **Build Output** - Standard React build process
- **No Environment Variables** - No configuration required
- **CDN Ready** - Optimized for content delivery networks

## 📋 Recent Updates & Bug Fixes

### v2.3.0 - Modern UI Design & Enhanced User Experience (September 2025)

#### 🎨 Revolutionary UI Overhaul
- **Stunning Theme-Based Header** - Beautiful rounded header with dynamic theme color integration and subtle transparency effects
- **Perfectly Centered Toolbar** - All circular buttons elegantly centered with proper visual balance and spacing
- **Frosted Glass Effect** - Modern backdrop blur creates elegant separation between header and content during scrolling
- **Smart Import File Display** - Shows imported filename with stylish badge design when HTML files are loaded
- **Auto-Closing Color Picker** - Streamlined color selection that closes automatically after theme selection

#### 🔄 Enhanced Toolbar Design
- **Unified Circular Icons** - Import/Export buttons now match the consistent circular design language
- **Optimal Button Spacing** - Perfect alignment and centering of all toolbar elements for professional appearance
- **Theme Color Integration** - Header background, borders, and title text all follow the selected theme color
- **Visual Hierarchy** - Clean separation between title area, toolbar, and content with proper padding and margins

#### 🛠️ Technical Excellence
- **Superior Z-Index Management** - Header stays perfectly visible above all content with proper layering (z-index: 9999)
- **Responsive Design** - Maintains visual integrity across different screen sizes and content lengths
- **Performance Optimized** - Smooth scrolling with efficient backdrop effects and minimal resource usage
- **Cross-Browser Compatibility** - Modern CSS effects work consistently across all supported browsers

### v2.2.0 - Text Direction and WYSIWYG Improvements (September 2025)

#### 🔧 Major Bug Fixes
- **Fixed Timeline RTL Text Issue** - Completely resolved persistent right-to-left text display by switching from contentEditable to native HTML input elements, eliminating reversed text like "1 tneve" and ensuring proper display like "Event 1"
- **Text Selection Restoration** - Fixed broken text selection in table cells where users couldn't select individual words or use double-click selection
- **Cursor Jump Prevention** - Eliminated cursor jumping to start of text blocks when typing in paragraphs, cards, and other contentEditable elements

#### ⚡ WYSIWYG Enhancements
- **Seamless Stat Card Editing** - Removed white background overlays and borders during editing while preserving original card styling
- **Timeline Input Optimization** - Converted timeline to native HTML input elements providing superior text direction control and eliminating RTL display issues
- **Fact Card Boundary Removal** - Eliminated editing boundaries for cleaner WYSIWYG experience across all card types

#### 🎯 Toolbar Improvements
- **Enhanced Bullet Lists** - Implemented inline bullet list formatting within paragraphs and cards (similar to Microsoft Word) rather than standalone blocks
- **Visual Button Labels** - Added text labels below all toolbar buttons for improved user experience and accessibility
- **Smart List Detection** - Bullet list button now appears only when editing compatible content types (paragraphs, cards, facts, citations)

#### 🔨 Technical Improvements
- **Consistent Content Management** - Standardized all contentEditable elements to use `innerHTML` for uniform text handling
- **Simplified Input Handlers** - Streamlined onInput functions removing complex cursor restoration logic that caused interference
- **Universal LTR Direction** - Applied comprehensive left-to-right text direction enforcement across all elements
- **Ref-Based Content Sync** - Eliminated `dangerouslySetInnerHTML` usage in favor of ref-based content management for better DOM control

#### 🎨 Visual Polish
- **Preserved Card Aesthetics** - Maintained original card fill colors, strokes, and visual styling during text editing
- **Cleaner Edit States** - Removed unnecessary visual boundaries and backgrounds that appeared during editing
- **Consistent Typography** - Ensured all text elements maintain proper font family and sizing throughout editing states

#### 🛠️ Architecture Enhancements
- **Unified Text Processing** - All text elements now follow the same content management pattern for consistency
- **Minimal DOM Manipulation** - Reduced aggressive CSS property setting in favor of browser-native text handling
- **Performance Optimization** - Simplified event handlers and reduced unnecessary re-renders during text editing

### Implementation Details

#### Timeline RTL Fix
The timeline RTL text issue was resolved by:
1. **Pattern Alignment** - Changed timeline elements to use the same `innerHTML` content management as working elements (paragraphs, cards)
2. **Simplified Handlers** - Replaced complex CSS property manipulation with minimal onInput handlers
3. **Content Consistency** - Ensured timeline follows the exact same pattern as other successfully working contentEditable elements

#### Text Selection Restoration
Table cell text selection was fixed by:
1. **DOM Interference Removal** - Eliminated `dangerouslySetInnerHTML` usage that was destroying browser selection ranges
2. **Ref-Based Management** - Implemented proper content synchronization through refs instead of JSX interpolation
3. **Native Selection Support** - Allowed browser's native text selection mechanisms to function properly

#### WYSIWYG Visual Improvements
Enhanced editing experience through:
1. **Background Removal** - Eliminated white backgrounds and editing overlays that disrupted visual continuity
2. **Border Elimination** - Removed temporary editing boundaries while maintaining focus indicators
3. **Style Preservation** - Kept original element styling (colors, fills, strokes) during editing states

## 🔥 Latest Features (Perfect Import/Export)

### 100% Format Fidelity
- **Theme Color Restoration** - Exported documents automatically restore their exact color scheme
- **Complete Bold Preservation** - All text formatting maintained through export/import cycle
- **Smart CSS Detection** - Converts CSS styling to editable HTML for seamless editing
- **Universal Compatibility** - Works with any previously exported A4 Editor document

### Advanced Import Processing
- **Dual Format Recognition** - Handles both HTML tags (`<b>`, `<strong>`) and CSS styles (`font-weight:bold`)
- **Theme State Recovery** - Automatically restores theme toggle settings from exported files
- **Intelligent Parsing** - Recreates exact document structure with full editing capabilities
- **Zero Data Loss** - Perfect preservation of all visual and structural elements

## 📋 Usage Tips & Tricks

### Efficient Workflow
1. **Start with Structure** - Add headings and major sections first
2. **Use Cards for Organization** - Group related content in cards
3. **Tables for Data** - Perfect for comparisons and structured information
4. **Stats for Metrics** - Highlight key numbers with stat grids
5. **Dividers for Separation** - Clean breaks between sections
6. **Export Frequently** - Save your work as HTML files for backup and sharing

### Formatting Best Practices
- **Consistent Theming** - Choose one theme color and stick with it
- **Selective Bold** - Use bold sparingly for emphasis across all elements
- **Logical Hierarchy** - Use H1 → H2 → H3 in order
- **White Space** - Let content breathe with proper spacing
- **Test Import/Export** - Verify formatting is preserved through the complete cycle

### Advanced Techniques
- **Mixed Content Cards** - Combine bold headers with regular text
- **Responsive Tables** - Design tables that work at different sizes
- **Color Coordination** - Match theme to your brand colors
- **Document Versioning** - Use export/import for document version control
- **Template Creation** - Export formatted documents as reusable templates

## 🤝 Contributing

This project welcomes contributions! Whether it's bug reports, feature requests, or code contributions, all are appreciated.

### Areas for Enhancement
- Additional text formatting options (italic, underline, colors)
- Image and media support
- More export formats (PDF, Word, Markdown)
- Collaborative editing features
- Template library and presets
- Advanced table features (cell merging, custom borders)

## 📄 License

MIT License - feel free to use this project for personal and commercial purposes.

---

**A4 Editor** - Professional document creation, simplified. 📄✨